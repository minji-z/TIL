# 추천 시스템



## 1. Content-based

**특정 아이템에 기초하여 비슷한 아이템을 추천, 사용자가 적은 초반의 추천 시스템의 경우 대부분 Content-based recommender를 사용.**

- **아이템끼리의 유사도를 측정합니다.**
- 아이템의 metadata를 사용합니다.
  - **Ex) 장르, 감독, 묘사, 배우, etc..**
- **만약 사용자가 특정 아이템을 선호한다고 하면, 해당 아이템과 유사한 아이템을 추천하는 방식입니다.**

#### **장단점**

- 장점
  - **다른 사용자의 영향을 받지 않는다.**
  - **새로운 아이템에 대해서도 추천이 가능하다.**
  - **추천을 설명하기 쉽다.**
- 단점
  - **새로운 유저에게 추천이 불가능하다.**
  - **소리, 영상, 이미지 등의 콘텐츠로부터 추천을 위한 metadate, 특징을 추출하기가 어렵다.**

#### **추천의 순서**

1. **아이템의 분류를 통해 콘텐츠를 분석합니다.**
2. **각각의 유저의 선호를 대표하는 유저의 profile을 학습합니다.**
3. **아이템의 분류 & 사용자 선호도에 따라 각각의 유저를 위한 추천 리스트를 생성합니다.**

#### **ML Techniques**

**사용되는 머신러닝 테크닉은 아래와 같습니다.**

- **KNN Classification (nearest neighbor)**
- **Linear Classification**



## 2. Collaborative Filtering

**사용자 그룹이 형성되어 있고, 그들 간의 평가 점수와 선호도를 고려하여, 사용자의 예측 점수와 선호도가 결정됩니다. **

**한마디로, 사용자와 비슷한 다른 사용자를 찾아서 그 사용자는 어떤 평가를 했는지를 살펴보는 방식입니다.**

**사용자가 어느 정도 형성이 되어있고, 데이터가 존재할 때 사용 가능한 추천 알고리즘 방식입니다.**

####  **장단점**

- 장점
  - **어떠한 아이템에 대해서도 추천이 가능하다. (아이템의 특성에 의존하지 않는다.)**
- 단점
  - **평가되지 않은 아이템에 대해 추천을 하지 않는다. (new-item problem)**
  - **보통 가장 인기 있는 아이템을 추천한다.**
  - **비슷한 유저 군이 존재하는 사용자 그룹이 어느 정도 숫자 이상 필요하다. (cold start problem for new users)**

#### **작동 방식**

- Input

  - **주어진 유저-아이템 간의 평가점수 matrix**

- Output

  - **특정 아이템에 대한 선호도 예측 점수**

  - **top-N 추천 리스트**

    

### 두 가지 방식의 CF

### 2-1) User-Based Filtering (UB-CF)

**유저들의 평가 점수를 바탕으로, 예측하고자 하는 유저의 점수를 예측하는 방식**

**영화를 추천하려는 활성 사용자와 유사한 사용자를 찾아서 항목 을 추천**

**특정 응용 프로그램은 사용자 기반 [Nearest Neighbor 알고리즘](https://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)**

- **Steps**
  1. **유저 간의 유사성 계산 (Pearson Correlation)**
     - 유사성 함수 ***w\*** 를 사용하여 각 사용자 쌍 사이의 거리를 측정 하여 사용자 ***a\*** 에 대한 KNN 최근 접 이웃을 찾습니다.
  2. **예측**
     - 사용자 ***a\*** 가 ***k\*** 이웃이 소비했지만 ***a\*** 가 소비 하지 않은 모든 항목에 부여 할 등급을 예측합니다 . 예상 평점이 가장 높은 항목 ***j\*** 를 찾습니다 .
- **장단점**
  - 장점
    1. **구현하기 쉽다.**
    2. **문맥이 독립적이다.**
    3. **contents-based에 비해 정확하다.**
  - 단점
    1. **희소성 : 항목을 평가하는 사용자가 적다.**
    2. **확장성 : 고려하는 *k* 이웃이 많을수록 더 나은 분류가 되지만, 시스템에 사용자가 많아지고 사용자 그룹이 커질수록 비용이 비싸진다.**
    3. **Cold Start : 신규 사용자에게는 다른 사용자와 비교할 정보가 거의 없어 추천이 힘들다.**
    4. **4번과 마찬가지로 새 항목은 견고한 순위를 생성하기위한 등급이 없다.**

### 2-1) Item-based Filtering (IB-CF)

**사용자 그룹을 사용하여, 관계를 판단하기에 CF에 포함**

**아이템 사이에 유사성을 판단하여 예측 (KNN Step을 건너뛴다.)**

**영화를 추천할 사용자에게 초점을 맞추는 대신 그가 좋아하는 것과 더 유사한 항목에 집중 **

- **Steps**
  1. 항목 간 유사성 계산
     - 코사인 기반 유사성
     - 상관 기반 유사성
     - 조정 된 코사인 유사성
     - 1-Jaccard 거리
  2. 예측 계산
     - 가중 합계
     - 회귀



### 사용자 기반 vs 아이템 기반

1. 아이템 기반은 K-Neighborhood 검색을 건너 뛰고 공동 등급 항목 간의 유사성을 직접 미리 계산.

2. 아마존과 넷플릭스를 비롯한 서비스에서는 대부분 아이템 기반을 활용한다고 알려져 있다. 

3. 또 적절한 UX를 위해서라면, 유저가 아이템을 평가하는 순간, 다른 아이템을 추천할 수 있어야 하는데,

   매 평가시마다 유사도 정보를 업데이트하는 것은 현실적으로 어려움 -> 

   아이템 기반에서는 일정 기간마다 유사도를 업데이트 하는 것으로도 충분히 위와 같은 적절한 UX를 제공할 수 있다.

4. 또 대부분의 경우는 사용자에 비해 아이템 수가 적기 때문에, 아이템 간의 관계 데이터가 발생할 확률이 높다.

    따라서 데이터가 누적될수록 추천의 정확도가 높아질 가능성이 더 높다.



