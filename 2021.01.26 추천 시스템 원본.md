# 추천 시스템

Content-based

Collaborative Filtering

- - 

### **Content-based Recommenders**

**간단하게 말하면, 특정 아이템에 기초하여 비슷한 아이템을 추천해준다는 것입니다.**

- **아이템끼리의 유사도를 측정합니다.**

- 아이템의 metadata를 사용합니다.

  - **Ex) 장르, 감독, 묘사, 배우, etc..**

- **만약 사용자가 특정 아이템을 선호한다고 하면, 해당 아이템과 유사한 아이템을 추천하는 방식입니다.**

  

**특징은 사람들 간을 비교하지 않고, 아이템 특성만을 비교한다는 점입니다. 사용자가 적은 초반의 추천 시스템의 경우 대부분 Content-based recommender를 사용합니다.**

#### **장단점**

- 장점
  - **다른 사용자의 영향을 받지 않는다.**
  - **새로운 아이템에 대해서도 추천이 가능하다.**
  - **추천을 설명하기 쉽다.**
- 단점
  - **새로운 유저에게 추천이 불가능하다.**
  - **소리, 영상, 이미지 등의 콘텐츠로부터 추천을 위한 metadate, 특징을 추출하기가 어렵다.**

#### **추천의 순서**

1. **아이템의 분류를 통해 콘텐츠를 분석합니다.**
2. **각각의 유저의 선호를 대표하는 유저의 profile을 학습합니다.**
3. **아이템의 분류 & 사용자 선호도에 따라 각각의 유저를 위한 추천 리스트를 생성합니다.**

#### **ML Techniques**

**사용되는 머신러닝 테크닉은 아래와 같습니다.**

- **KNN Classification (nearest neighbor)**
- **Linear Classification**



### **Collaborative Filtering Recommenders**

**사용자 그룹이 형성되어 있고, 그들 간의 평가 점수와 선호도를 고려하여, 사용자의 예측 점수와 선호도가 결정됩니다. 한마디로, 사용자와 비슷한 다른 사용자를 찾아서 그 사용자는 어떤 평가를 했는지를 살펴보는 방식입니다.**

**사용자가 어느 정도 형성이 되어있고, 데이터가 존재할 때 사용 가능한 추천 알고리즘 방식입니다.**

#### **장단점**

- 장점
  - **어떠한 아이템에 대해서도 추천이 가능하다. (아이템의 특성에 의존하지 않는다.)**
- 단점
  - **평가되지 않은 아이템에 대해 추천을 하지 않는다. (new-item problem)**
  - **보통 가장 인기 있는 아이템을 추천한다.**
  - **비슷한 유저 군이 존재하는 사용자 그룹이 어느 정도 숫자 이상 필요하다. (cold start problem for new users)**

#### **작동 방식**

- Input
  - **주어진 유저-아이템 간의 평가점수 matrix**
- Output
  - **특정 아이템에 대한 선호도 예측 점수**
  - **top-N 추천 리스트**

#### **두 가지 방식의 CF**



![img](https://blog.kakaocdn.net/dn/ds6l87/btqAY7plYf2/bC60dU0RuwqorkkpOkqT70/img.png)



- **User-Based Filtering**

  - **유저들의 평가 점수를 바탕으로, 예측하고자 하는 유저의 점수를 예측하는 방식**

    ![img](https://blog.kakaocdn.net/dn/MrBmS/btqAXQ2XgaK/ZU5YKc0JJCkRIDGQjHQhvK/img.png)User-

  - **Steps**

    1. **유저 간의 유사성 계산 (Pearson Correlation)**
    2. **예측**

  - **장단점**

    - 장점
      1. **구현하기 쉽다.**
      2. **문맥이 독립적이다.**
      3. **contents-based에 비해 정확하다.**
    - 단점
      1. **희소성 : 평가를 하는 사용자가 적다.**
      2. **확장성 : 사용자 그룹이 커질수록 비용이 비싸다.**
      3. **Cold Start : 신규 사용자에게 추천이 힘들다.**

- **Item-based Filtering**

  - **사용자 그룹을 사용하여, 관계를 판단하기에 CF에 포함됩니다.**

  - **아이템 사이에 유사성을 판단하여 예측을 합니다. (KNN Step을 건너뛴다.)**

    ![img](https://blog.kakaocdn.net/dn/tIPVK/btqAVIyfbxS/8QkDxiGz96cpWmYLxtDBw0/img.png)Item-based CF

  - **User-based보다 더 좋은 성능을 보여줍니다.**



### **Hybrid Recommender Systems**

**데이터와 상황에 따라 Content-based와 Collaborative filtering을 적절히 섞어서 사용하는 방식입니다.**



# 사용자 기반 협업 필터링 (UB-CF)

우리 친구 *Stan l ey* 에게 영화를 추천하고 싶다고 상상해보십시오 . 비슷한 사람들이 비슷한 취향을 가질 것이라고 가정 할 수 있습니다. 나와 *Stanley* 가 같은 영화를 보았고 우리가 거의 같은 영화를 봤다고 가정 해 보겠습니다. 그러나 Stanley는 *'The Godfather : Part II'* 를 보지 못했고 나는 봤습니다 *.* 내가 그 영화를 좋아한다면 그도 그렇게 될 것이라고 생각하는 것이 논리적으로 들린다. 이를 통해 유사성을 기반으로 인공 등급을 만들었습니다.

글쎄요, UB-CF는이 논리를 사용 하여 영화를 추천하려는 *활성 사용자* 와 유사한 사용자를 찾아서 항목 을 추천합니다. 이에 대한 특정 응용 프로그램은 사용자 기반 [Nearest Neighbor 알고리즘](https://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm) 입니다. 이 알고리즘에는 두 가지 작업이 필요합니다.

\1. 유사성 함수 ***w\*** 를 사용하여 각 사용자 쌍 사이의 거리를 측정 하여 사용자 ***a\*** 에 대한 KNN (최근 접 이웃)을 찾습니다 .

\2. 사용자 ***a\*** 가 ***k\*** 이웃이 소비했지만 ***a\*** 가 소비 하지 않은 모든 항목에 부여 할 등급을 예측합니다 . 예상 평점이 가장 높은 항목 ***j\*** 를 찾습니다 .

즉, 다른 유사한 사용자를 기반으로 활성 사용자가 보지 못한 항목에 대한 평가를 예측하는 사용자 항목 매트릭스를 생성합니다. 이 기술은 **메모리 기반** .

## 장점 :

- 구현하기 쉽습니다.
- 문맥 독립적.
- 콘텐츠 기반과 같은 다른 기술에 비해 더 정확합니다.

## 단점 :

- 희소성: 항목을 평가하는 사람들의 비율이 정말 낮습니다.
- 확장성 : 고려하는 ***K\*** 이웃 이 많을수록 (특정 임계 값 아래에서) 더 나은 분류가됩니다. 그럼에도 불구하고 시스템에 사용자가 많을수록 가장 가까운 K 이웃을 찾는 데 드는 비용이 증가합니다.
- 콜드 스타트 : 신규 사용자는 다른 사용자와 비교할 정보가 거의 없습니다.
- 새 항목 : 마지막 포인트와 마찬가지로 새 항목은 견고한 순위를 생성하기위한 등급이 없습니다.

# 항목 기반 협업 필터링 (IB-CF)

*Stanley로* 돌아 가기 . 그의 친구에게 초점을 맞추는 대신 모든 옵션의 항목이 그가 좋아하는 것과 더 유사한 항목에 집중할 수 있습니다. 이 새로운 초점을 항목 기반 협업 필터링 (IB-CF)이라고합니다.

IB-CF를 두 가지 하위 작업으로 나눌 수 있습니다.

\1. 항목 간의 유사성을 계산합니다.

- 코사인 기반 유사성
- 상관 기반 유사성
- 조정 된 코사인 유사성
- 1-Jaccard 거리

\2. 예측 계산 :

- 가중 합계
- 회귀

UB-CF와이 방법의 차이점은이 경우 K-Neighborhood 검색을 건너 뛰고 공동 등급 항목 간의 유사성을 직접 미리 계산한다는 것입니다.

## 슬로프 원

Slope One은 항목 기반 협업 필터링 제품군의 일부로 **Daniel Lemire** 와 **Anna Maclachlan** 의 2005 년 논문에서 [Slope One Predictors for Online Rating-Based Collaborative Filtering](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.60.4503&rep=rep1&type=pdf) 이라는 이름으로 소개되었습니다 .

이 모델의 기본 아이디어는 다음과 같습니다.

두 명의 다른 사용자 ***A\*** 와 ***B\*** 가 있다고 가정 합니다. 또한 ***항목 I\*** 및 ***항목 J가\*** 있습니다. *사용자 A* 는 *항목 I* 를 별표 1 개로, *항목 J* 는 1.5로 평가했습니다. *사용자 B가* *항목 I* 을 2로 평가 한 경우 두 항목 간의 차이가 *사용자 A* 와 동일 할 것이라고 가정 할 수 있습니다 . 이를 염두에두고 *사용자 B* 는 *항목 J* 를 다음과 같이 평가합니다. 2+ (1,5–1) = 2,5

![게시물 이미지](https://miro.medium.com/max/60/1*CL8Ch0YOgzJjgyiE2_YT2g.png?q=20)

![게시물 이미지](https://miro.medium.com/max/2196/1*CL8Ch0YOgzJjgyiE2_YT2g.png)

Slope One의 주요 아이디어

저자는 5 가지 목표에 중점을 둡니다.
\1. 구현 및 유지 관리가 쉽습니다.
\2. 온라인 업데이트 가능 : 새로운 등급은 예측을 빠르게 변경해야합니다.
\3. 상담시 효율성 : 스토리지가 주요 비용입니다.
\4. 사용자 피드백이 거의없이 작동합니다.
\5. 약간의 정확도 향상이 단순성과 확장 성의 큰 희생을 의미하지 않는 특정 범위 내에서 합리적으로 정확합니다.

# 요약

사용자 기반 및 항목 기반 협업 필터링을 보았습니다. 첫 번째는 사용자 항목 매트릭스를 채우고 활성 사용자와 더 유사한 사용자를 기반으로 추천하는 데 중점을 둡니다. 반면 IB-CF는 Item-Item 매트릭스를 채우고 유사한 항목을 기반으로 추천합니다.

이 모든 주제를 간략하게 설명하기는 어렵지만,이를 이해하는 것이 RecSys에 대해 더 깊이 들어가는 첫 번째 단계입니다.





사용자 기반 따라해볼 페이지 : https://kutar37.tistory.com/entry/%ED%8C%8C%EC%9D%B4%EC%8D%AC-%ED%98%91%EC%97%85%ED%95%84%ED%84%B0%EB%A7%81Collaborative-Filtering-%EC%B6%94%EC%B2%9C-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-1